%% Enhanced Custom Commands for Energy Data Visualization
% ============================================================================
% Basic Highlighting and Emphasis
% ============================================================================
\newcommand{\highlight}[1]{\textcolor{renewable}{\textbf{#1}}}
\newcommand{\concept}[1]{\textcolor{coalplant}{\textit{#1}}}
\newcommand{\important}[1]{\textcolor{red!70!black}{\textbf{#1}}}
\newcommand{\note}[1]{\textcolor{gray}{\footnotesize #1}}

% ============================================================================
% Energy Units and Values
% ============================================================================
\newcommand{\energyunit}[1]{\SI{#1}{\mega\watt\hour}}
\newcommand{\power}[1]{\SI{#1}{\mega\watt}}
\newcommand{\powerGW}[1]{\SI{#1}{\giga\watt}}
\newcommand{\capacity}[1]{\SI{#1}{\percent}}
\newcommand{\emission}[1]{\SI{#1}{\tonne\per\capita}}
\newcommand{\price}[1]{\SI{#1}{PLN\per\kilo\watt\hour}}
\newcommand{\pricePPS}[1]{\SI{#1}{PPS}}

% CO2 with subscript
\newcommand{\COtwo}{CO\textsubscript{2}\xspace}

% ============================================================================
% Robust Include Commands with Error Handling
% ============================================================================
% Include section with fallback
\newcommand{\includesection}[1]{%
    \IfFileExists{sections/#1.tex}{%
        \input{sections/#1.tex}%
    }{%
        \begin{frame}{Missing Section}
            \centering
            \Large\textcolor{red}{Section file not found:}\\
            \texttt{sections/#1.tex}
        \end{frame}%
    }%
}

% Include figure with fallback
\newcommand{\includefigure}[1]{%
    \IfFileExists{figures/#1.tex}{%
        \input{figures/#1.tex}%
    }{%
        \missingfigure{figures/#1.tex}%
    }%
}

% Include table with fallback
\newcommand{\includetable}[1]{%
    \IfFileExists{tables/#1.tex}{%
        \input{tables/#1.tex}%
    }{%
        \begin{center}
            \fbox{\textcolor{red}{Missing table: \texttt{tables/#1.tex}}}
        \end{center}%
    }%
}

% ============================================================================
% Energy Source Icons and Labels
% ============================================================================
\newcommand{\coalicon}{\textcolor{coalplant}{\faIcon{industry}}\xspace}
\newcommand{\gasicon}{\textcolor{gasplant}{\faIcon{fire}}\xspace}
\newcommand{\nuclearicon}{\textcolor{nuclear}{\faIcon{atom}}\xspace}
\newcommand{\hydroicon}{\textcolor{hydro}{\faIcon{water}}\xspace}
\newcommand{\windicon}{\textcolor{wind}{\faIcon{wind}}\xspace}
\newcommand{\solaricon}{\textcolor{solar}{\faIcon{sun}}\xspace}
\newcommand{\renewableicon}{\textcolor{renewable}{\faIcon{leaf}}\xspace}

% Energy source labels with icons
\newcommand{\coallabel}{\coalicon Węgiel}
\newcommand{\gaslabel}{\gasicon Gaz}
\newcommand{\nuclearlabel}{\nuclearicon Atom}
\newcommand{\hydrolabel}{\hydroicon Woda}
\newcommand{\windlabel}{\windicon Wiatr}
\newcommand{\solarlabel}{\solaricon Słońce}
\newcommand{\renewablelabel}{\renewableicon OZE}

% ============================================================================
% Country Flags and Names
% ============================================================================
\newcommand{\poland}{\faIcon{flag} Polska}
\newcommand{\germany}{\faIcon{flag} Niemcy}
\newcommand{\france}{\faIcon{flag} Francja}
\newcommand{\sweden}{\faIcon{flag} Szwecja}

% ============================================================================
% Data Visualization Helpers
% ============================================================================
% Trend indicators
\newcommand{\trendup}[1]{\textcolor{green}{\faIcon{arrow-up} #1\%}}
\newcommand{\trenddown}[1]{\textcolor{red}{\faIcon{arrow-down} #1\%}}
\newcommand{\trendstable}[1]{\textcolor{gray}{\faIcon{minus} #1\%}}

% Comparison helpers
\newcommand{\better}[1]{\textcolor{green!70!black}{#1}}
\newcommand{\worse}[1]{\textcolor{red!70!black}{#1}}
\newcommand{\neutral}[1]{\textcolor{gray}{#1}}

% ============================================================================
% Frame Helpers
% ============================================================================
% Quick alert box
\newcommand{\alertbox}[2][red]{%
    \begin{tcolorbox}[colback=#1!10,colframe=#1!50!black]
        #2
    \end{tcolorbox}%
}

% Quick info box
\newcommand{\infobox}[2][blue]{%
    \begin{tcolorbox}[colback=#1!10,colframe=#1!50!black,title=Info]
        #2
    \end{tcolorbox}%
}

% Key takeaway box
\newcommand{\keypoint}[1]{%
    \begin{tcolorbox}[colback=renewable!10,colframe=renewable!50!black,title=Kluczowy wniosek]
        #1
    \end{tcolorbox}%
}

% ============================================================================
% Table Formatting
% ============================================================================
% Highlight Poland in tables
\newcommand{\poland}[1]{\textcolor{renewable}{\textbf{#1}}}

% Best/worst values in tables
\newcommand{\best}[1]{\cellcolor{green!20}#1}
\newcommand{\worst}[1]{\cellcolor{red!20}#1}

% ============================================================================
% Chart and Plot Helpers
% ============================================================================
% Standard plot size
\newcommand{\plotwidth}{0.8\textwidth}
\newcommand{\plotheight}{0.6\textheight}

% Standard bar chart colors
\definecolor{barcolor1}{HTML}{4CAF50}
\definecolor{barcolor2}{HTML}{2196F3}
\definecolor{barcolor3}{HTML}{FF9800}
\definecolor{barcolor4}{HTML}{F44336}
\definecolor{barcolor5}{HTML}{9C27B0}

% ============================================================================
% Source Citations
% ============================================================================
\newcommand{\datasource}[1]{%
    \vfill
    \begin{flushright}
        \tiny\textcolor{gray}{Źródło danych: #1}
    \end{flushright}%
}

\newcommand{\updatedate}[1]{%
    \begin{flushright}
        \tiny\textcolor{gray}{Aktualizacja: #1}
    \end{flushright}%
}

% ============================================================================
% Progress Indicators
% ============================================================================
\newcommand{\progressbar}[2]{%
    \begin{tikzpicture}[baseline]
        \draw[gray!30,line width=4pt] (0,0) -- (3,0);
        \draw[renewable,line width=4pt] (0,0) -- ({3*#1/100},0);
        \node[right] at (3.1,0) {\small #2\%};
    \end{tikzpicture}%
}

% ============================================================================
% Comparison Arrows
% ============================================================================
\newcommand{\comparearrow}[3]{%
    % #1: left value, #2: right value, #3: label
    \begin{tikzpicture}[baseline]
        \node (a) at (0,0) {#1};
        \node (b) at (3,0) {#2};
        \draw[->,thick,renewable] (a) -- (b);
        \node[above] at (1.5,0) {\footnotesize #3};
    \end{tikzpicture}%
}

% ============================================================================
% Quick Statistics
% ============================================================================
\newcommand{\statbox}[3]{%
    % #1: icon, #2: value, #3: label
    \begin{tcolorbox}[width=3cm,colback=gray!10,colframe=gray!50,boxrule=0.5pt]
        \centering
        \Large #1\\[0.2em]
        \textbf{\large #2}\\[0.1em]
        \footnotesize #3
    \end{tcolorbox}%
}

% ============================================================================
% Year Range
% ============================================================================
\newcommand{\yearrange}[2]{#1--#2}
\newcommand{\currentyear}{2024}

% ============================================================================
% Quick Lists for Energy Types
% ============================================================================
\newcommand{\energylist}[1]{%
    \begin{itemize}[leftmargin=*]
        #1
    \end{itemize}%
}

\newcommand{\energyitem}[2]{%
    \item #1 \hfill \textbf{#2}%
}